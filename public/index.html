<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Firebase</title>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q" crossorigin="anonymous"></script>
</head>
<body class="bg-dark text-light text-center p-3">
        <h1 class="text-light">Sign up</h1>
<div class="container mt-5 mb-5 p-3 rounded shadow bg-body-secondary d-flex flex-column align-items-center">
    <button onclick="SignG()" class="mb-3 shadow">Sign up with Google</button>
    <input type="text" id="fName" placeholder="First Name" style="border-radius: 5px; margin-right: 10px;" />
    <input type="text" id="lName" placeholder="Last Name" style="border-radius: 5px; margin-right: 10px;" />
    <input type="text" id="password" placeholder=" Password" style="border-radius: 5px; margin-right: 10px;" />
    <input type="text" id="email" placeholder="Email" style="border-radius: 5px; margin-right: 10px;" />
    <button onclick="SignU()">Submit</button>
  </div>

    </div>
  
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
    import { getAuth, GoogleAuthProvider, signInWithPopup, sendEmailVerification, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-auth.js";


  const firebaseConfig = {
    apiKey: "AIzaSyBvK9xM48PeYkF5ex8AqAXDjgue1FeyAeA",
    authDomain: "project-2-x.firebaseapp.com",
    projectId: "project-2-x",
    storageBucket: "project-2-x.firebasestorage.app",
    messagingSenderId: "677458061136",
    appId: "1:677458061136:web:f1ecebf80c6bea6a812e55"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const auth = getAuth();
  const provider = new GoogleAuthProvider();
  const googleProvider = new GoogleAuthProvider();

  function SignU() {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      const firstName = document.getElementById("fName").value;
      const lastName = document.getElementById("lName").value;

      if (!email || !password || !firstName || !lastName) {
        alert("fill up goat.");
      } else {
        let userObj = {
          email: email,
          password: password,
          firstName: firstName,
          lastName: lastName,
        };
        console.log(userObj);
      }
      createUserWithEmailAndPassword(auth, email, password)
        .then((userCredential) => {
          const user = userCredential.user;
          console.log(user);
           user ? (window.location.href = "signin.html")
            : (window.location.href = "index.html");
        })
        .catch((err) => {
          const code = err.code;
          console.log(code);
            if (code == "auth/email-already-in-use") {
           alert('account already exists.');
      }
          if (code == "auth/password-does-not-meet-requirements") {
          alert('Weak password.');
      }
        });
    }

    function SignG() {
      signInWithPopup(auth, googleProvider)
        .then((result) => {
          const user = result.user;
          console.log("Signed in with Google:", user);

          sendEmailVerification(user)
            .then(() => console.log("Verification email sent."))
            .catch((error) => console.error("Verification error:", error));

          user
            ? (window.location.href = "dashboard.html")
            : (window.location.href = "index.html");
        })
        .catch((error) => {
          console.error("Google sign-in error:", error);
          alert("Google sign-in failed.");
        });
    }

    window.SignU = SignU;
    window.SignG = SignG;
</script>
</body>

</html>